

class AutocompleteSystemBuilder
{
    private IRankingStrategy rankingStrategy = new FrequencyBasedRanking(); // Default strategy
    private int maxSuggestions = 10; // Default limit

    public AutocompleteSystemBuilder WithRankingStrategy(IRankingStrategy strategy)
    {
        this.rankingStrategy = strategy;
        return this;
    }

    public AutocompleteSystemBuilder WithMaxSuggestions(int max)
    {
        this.maxSuggestions = max;
        return this;
    }

    public AutocompleteSystem Build()
    {
        return new AutocompleteSystem(rankingStrategy, maxSuggestions);
    }
}





class Suggestion
{
    private readonly string word;
    private readonly int weight;

    public Suggestion(string word, int weight)
    {
        this.word = word;
        this.weight = weight;
    }

    public string GetWord()
    {
        return word;
    }

    public int GetWeight()
    {
        return weight;
    }
}








class Trie
{
    private readonly TrieNode root;

    public Trie()
    {
        root = new TrieNode();
    }

    public void Insert(string word)
    {
        TrieNode current = root;
        foreach (char ch in word)
        {
            if (!current.GetChildren().ContainsKey(ch))
            {
                current.GetChildren()[ch] = new TrieNode();
            }
            current = current.GetChildren()[ch];
        }
        current.SetEndOfWord(true);
        current.IncrementFrequency();
    }

    public TrieNode SearchPrefix(string prefix)
    {
        TrieNode current = root;
        foreach (char ch in prefix)
        {
            if (!current.GetChildren().TryGetValue(ch, out TrieNode node))
            {
                return null;
            }
            current = node;
        }
        return current;
    }

    public List<Suggestion> CollectSuggestions(TrieNode startNode, string prefix)
    {
        List<Suggestion> suggestions = new List<Suggestion>();
        Collect(startNode, prefix, suggestions);
        return suggestions;
    }

    private void Collect(TrieNode node, string currentPrefix, List<Suggestion> suggestions)
    {
        if (node.IsEndOfWord())
        {
            suggestions.Add(new Suggestion(currentPrefix, node.GetFrequency()));
        }

        foreach (var kvp in node.GetChildren())
        {
            Collect(kvp.Value, currentPrefix + kvp.Key, suggestions);
        }
    }
}









class TrieNode
{
    private readonly Dictionary<char, TrieNode> children = new Dictionary<char, TrieNode>();
    private bool isEndOfWord;
    private int frequency;

    public Dictionary<char, TrieNode> GetChildren()
    {
        return children;
    }

    public bool IsEndOfWord()
    {
        return isEndOfWord;
    }

    public void SetEndOfWord(bool endOfWord)
    {
        isEndOfWord = endOfWord;
    }

    public int GetFrequency()
    {
        return frequency;
    }

    public void IncrementFrequency()
    {
        frequency++;
    }
}








class AlphabeticalRanking : IRankingStrategy
{
    public List<Suggestion> Rank(List<Suggestion> suggestions)
    {
        return suggestions.OrderBy(s => s.GetWord()).ToList();
    }
}








class FrequencyBasedRanking : IRankingStrategy
{
    public List<Suggestion> Rank(List<Suggestion> suggestions)
    {
        return suggestions.OrderByDescending(s => s.GetWeight()).ToList();
    }
}




interface IRankingStrategy
{
    List<Suggestion> Rank(List<Suggestion> suggestions);
}






using System;
using System.Collections.Generic;
using System.Linq;

public class AutocompleteDemo
{
    public static void Main(string[] args)
    {
        Console.WriteLine("----------- SCENARIO 1: Frequency-based Ranking -----------");

        // 1. Build the system with the default frequency-based strategy
        AutocompleteSystem systemByFrequency = new AutocompleteSystemBuilder()
                .WithMaxSuggestions(5)
                .WithRankingStrategy(new FrequencyBasedRanking())
                .Build();

        // 2. Feed data into the system
        // 'canada' is added most frequently, followed by 'car'
        List<string> dictionary = new List<string>
        {
            "car", "cat", "cart", "cartoon", "canada", "candy",
            "car", "canada", "canada", "car", "canada", "canopy", "captain"
        };
        systemByFrequency.AddWords(dictionary);

        // 3. Get suggestions for a prefix
        string prefix1 = "ca";
        List<string> suggestions1 = systemByFrequency.GetSuggestions(prefix1);
        Console.WriteLine($"Suggestions for '{prefix1}': [{string.Join(", ", suggestions1)}]");

        string prefix2 = "car";
        List<string> suggestions2 = systemByFrequency.GetSuggestions(prefix2);
        Console.WriteLine($"Suggestions for '{prefix2}': [{string.Join(", ", suggestions2)}]");

        Console.WriteLine("\n----------- SCENARIO 2: Alphabetical Ranking -----------");

        // 1. Build a new system with the alphabetical strategy
        AutocompleteSystem systemAlphabetical = new AutocompleteSystemBuilder()
                .WithRankingStrategy(new AlphabeticalRanking())
                .Build();

        // 2. Feed the same data
        systemAlphabetical.AddWords(dictionary);

        // 3. Get suggestions for the same prefix
        List<string> suggestions3 = systemAlphabetical.GetSuggestions(prefix1);
        Console.WriteLine($"Suggestions for '{prefix1}' (alphabetical): [{string.Join(", ", suggestions3)}]");
    }
}






class AutocompleteSystem
{
    private readonly Trie trie;
    private readonly IRankingStrategy rankingStrategy;
    private readonly int maxSuggestions;

    public AutocompleteSystem(IRankingStrategy rankingStrategy, int maxSuggestions)
    {
        this.trie = new Trie();
        this.rankingStrategy = rankingStrategy;
        this.maxSuggestions = maxSuggestions;
    }

    public void AddWord(string word)
    {
        trie.Insert(word.ToLower());
    }

    public void AddWords(List<string> words)
    {
        foreach (string word in words)
        {
            AddWord(word);
        }
    }

    public List<string> GetSuggestions(string prefix)
    {
        TrieNode prefixNode = trie.SearchPrefix(prefix.ToLower());
        if (prefixNode == null)
        {
            return new List<string>();
        }

        List<Suggestion> rawSuggestions = trie.CollectSuggestions(prefixNode, prefix.ToLower());
        List<Suggestion> rankedSuggestions = rankingStrategy.Rank(rawSuggestions);

        return rankedSuggestions
            .Take(maxSuggestions)
            .Select(s => s.GetWord())
            .ToList();
    }
}




































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































